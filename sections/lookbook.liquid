<section class="lbsection">
   {% if section.settings.heading!=blank %}
    <h2 class="lbheading">{{ section.settings.heading}}</h2>
   {% endif %}

   <div class="lbblocks">
    {% for block in section.blocks %}
        <div class="lbblock" {{ block.shopify_attributes }}>

            <div class="lbbanner">
                {% if block.settings.lbbanner!=blank %}
                    <img src="{{ block.settings.lbbanner | image_url }}" alt="LB Banner">
                    <div class="lbbanner-overlay">
                        {% if block.settings.lbbanner_heading!=blank %}
                            <h3>{{ block.settings.lbbanner_heading }}</h3>
                        {% endif %}
                        {% if block.settings.lbbutton!=blank %}
                            <a href="{{ block.settings.lbbuttonlink }}" class="lb-button">{{ block.settings.lbbutton }}</a>
                        {%  endif %}
                    </div>
                {% endif %}
            </div>

            <div class="lbproducts">
                <div class="lbproduct-wrapper" data-slider-id="slider-{{ block.id }}">
                    <button class="lb-arrow lb-prev" type="button" aria-label="Previous">‹</button>
                    <div class="lbproduct-slider">
                        {% if block.settings.product_1 != blank %}
                            {% assign product = block.settings.product_1 %}
                            <div class="lbproduct-card">
                                <a href="{{ product.url }}">
                                    {% unless product.available %}
                                        <span class="sold-out-badge">Sold Out</span>
                                    {% endunless %}
                                    <div class="product-image-wrapper">
                                        <img src="{{ product.featured_image | image_url: width: 400 }}" alt="{{ product.title }}">
                                    </div>
                                    <p class="title">{{ product.title }}</p>
                                    <p class="price">{{ product.price | money }}</p>
                                </a>
                            </div>
                        {% endif %}

                        {% if block.settings.product_2 != blank %}
                            {% assign product = block.settings.product_2 %}
                            <div class="lbproduct-card">
                                <a href="{{ product.url }}">
                                    {% unless product.available %}
                                        <span class="sold-out-badge">Sold Out</span>
                                    {% endunless %}
                                    <div class="product-image-wrapper">
                                        <img src="{{ product.featured_image | image_url: width: 400 }}" alt="{{ product.title }}">
                                    </div>
                                    <p class="title">{{ product.title }}</p>
                                    <p class="price">{{ product.price | money }}</p>
                                </a>
                            </div>
                        {% endif %}

                        {% if block.settings.product_3 != blank %}
                            {% assign product = block.settings.product_3 %}
                            <div class="lbproduct-card">
                                <a href="{{ product.url }}">
                                    {% unless product.available %}
                                        <span class="sold-out-badge">Sold Out</span>
                                    {% endunless %}
                                    <div class="product-image-wrapper">
                                        <img src="{{ product.featured_image | image_url: width: 400 }}" alt="{{ product.title }}">
                                    </div>
                                    <p class="title">{{ product.title }}</p>
                                    <p class="price">{{ product.price | money }}</p>
                                </a>
                            </div>
                        {% endif %}

                        {% if block.settings.product_4 != blank %}
                            {% assign product = block.settings.product_4 %}
                            <div class="lbproduct-card">
                                <a href="{{ product.url }}">
                                    {% unless product.available %}
                                        <span class="sold-out-badge">Sold Out</span>
                                    {% endunless %}
                                    <div class="product-image-wrapper">
                                        <img src="{{ product.featured_image | image_url: width: 400 }}" alt="{{ product.title }}">
                                    </div>
                                    <p class="title">{{ product.title }}</p>
                                    <p class="price">{{ product.price | money }}</p>
                                </a>
                            </div>
                        {% endif %}
                    </div>
                    <button class="lb-arrow lb-next" type="button" aria-label="Next">›</button>
                    <div class="slider-pagination"></div>
                </div>
            </div>
                
        </div>
    {% endfor %}
    </div>
</section>

<style>
    .lbsection {
    padding: 60px 0;
    }

    .lbheading {
    text-align: center;
    font-size: 30px;
    margin-bottom: 40px;
    }

    .lbblock {
    display: flex;
    gap: 30px;
    margin-left: -40px;
    margin-right: -40px;
    width: calc(100% + 80px);
    align-items: stretch;
    }

    
    .lbbanner {
    width: 50%;
    position: relative;
    flex-shrink: 0;
    min-height: 600px;
    }

    .lbbanner img {
    width: 100%;
    height: 100%;
    min-height: 600px;
    object-fit: cover;
    border-radius: 12px;
    display: block;
    }

    .lbbanner-overlay {
    position: absolute;
    bottom: 20px;
    left: 20px;
    right: 20px;
    background: #fff;
    padding: 12px 24px;
    border-radius: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 2;
    }

    .lbbanner-overlay h3 {
    font-size: 15px;
    margin: 0;
    }

    .lb-button {
    padding: 10px 18px;
    background: #1f3d2b;
    color: #fff;
    border-radius: 25px;
    text-decoration: none;
    font-size: 14px;
    white-space: nowrap;
    }

    .lbproducts {
    width: 50%;
    display: flex;
    flex-direction: column;
    min-height: 600px;
    }

    .lbproduct-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
    min-height: 600px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: center;
    }

    .lbproduct-slider {
    display: flex;
    transition: transform 0.4s ease;
    width: 100%;
    height: 100%;
    }

    .lbproduct-card {
    flex: 0 0 100%;
    min-width: 0;
    padding: 40px 20px;
    background: transparent;
    text-align: center;
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    }

    .product-image-wrapper {
    width: 70%;
    max-width: 350px;
    height: 400px;
    background: #f5f5f5;
    border-radius: 8px;
    overflow: hidden;
    margin: 40px auto 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    }

    .lbproduct-card img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 8px;
    }

    .sold-out-badge {
    position: absolute;
    top: 24px;
    left: 24px;
    background: #f5f5f5;
    color: #000;
    padding: 4px 12px;
    font-size: 12px;
    border-radius: 4px;
    z-index: 2;
    font-weight: 500;
    }

    .lbproduct-card .title {
    font-size: 16px;
    margin: 0 0 8px 0;
    color: #000;
    line-height: 1.4;
    font-weight: 400;
    }

    .lbproduct-card .price {
    font-size: 16px;
    font-weight: 600;
    color: #000;
    margin: 0;
    }

    .lbproduct-card a {
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
    height: 100%;
    }

    .lb-arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 42px;
    height: 42px;
    border-radius: 50%;
    background: #1f3d2b;
    color: #fff;
    border: none;
    cursor: pointer;
    z-index: 3;
    font-size: 22px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.3s ease;
    }

    .lb-arrow:hover {
    background: #163021;
    }

    .lb-prev { 
    left: 10px; 
    }

    .lb-next { 
    right: 10px; 
    }

    .slider-pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
    margin-top: 20px;
    }

    .pagination-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #ddd;
    cursor: pointer;
    transition: all 0.3s ease;
    }

    .pagination-dot.active {
    background: #000;
    width: 24px;
    border-radius: 4px;
    }


/* Mobile */
@media (max-width: 768px) {
    .lbsection {
        padding: 30px 0;
    }

    .lbheading {
        font-size: 22px;
        margin-bottom: 24px;
        padding: 0 16px;
    }

    .lbblock {
        flex-direction: column; 
        gap: 0;
        margin-left: 0;
        margin-right: 0;
        margin-bottom: 24px;
        width: 100% !important;
    }

    .lbblock:last-child {
        margin-bottom: 0;
    }

    .lbbanner {
        width: 100%;
        border-radius: 0;
    }

    .lbbanner img {
        border-radius: 0;
        width: 100%;
        height: auto;
        display: block;
    }

    .lbbanner-overlay {
        bottom: 16px;
        left: 16px;
        right: 16px;
        padding: 12px 16px;
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
    }

    .lbbanner-overlay h3 {
        font-size: 14px;
        margin: 0;
    }

    .lb-button {
        padding: 10px 20px;
        font-size: 13px;
        width: 100%;
        text-align: center;
    }

    .lbproducts {
        width: 100%;
        padding: 16px;
    }

    .lbproduct-card {
        padding: 12px;
    }

    .sold-out-badge {
        top: 20px;
        left: 20px;
        font-size: 11px;
        padding: 3px 10px;
    }

    .lbproduct-card .title {
        font-size: 13px;
        margin: 0 0 6px 0;
        line-height: 1.3;
    }

    .lbproduct-card .price {
        font-size: 14px;
        font-weight: 600;
    }

    .slider-pagination {
        margin-top: 16px;
        gap: 6px;
    }

    .pagination-dot {
        width: 6px;
        height: 6px;
    }

    .pagination-dot.active {
        width: 20px;
    }

    .lb-arrow {
        width: 36px;
        height: 36px;
        font-size: 20px;
    }

    .lb-prev {
        left: 8px;
    }

    .lb-next {
        right: 8px;
    }
}

</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.lbproduct-wrapper').forEach(wrapper => {
    const slider = wrapper.querySelector('.lbproduct-slider');
    const slides = slider.querySelectorAll('.lbproduct-card');
    const prev = wrapper.querySelector('.lb-prev');
    const next = wrapper.querySelector('.lb-next');
    const pagination = wrapper.querySelector('.slider-pagination');
    
    if (slides.length === 0) return;
    
    let currentIndex = 0;
    
    // Create pagination dots
    slides.forEach((_, index) => {
      const dot = document.createElement('div');
      dot.className = 'pagination-dot' + (index === 0 ? ' active' : '');
      dot.addEventListener('click', () => goToSlide(index));
      pagination.appendChild(dot);
    });
    
    const dots = pagination.querySelectorAll('.pagination-dot');
    
    function updateSlider() {
      slider.style.transform = `translateX(-${currentIndex * 100}%)`;
      
      // Update pagination dots
      dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === currentIndex);
      });
      
      // Update arrow states
      if (prev) {
        prev.style.opacity = currentIndex === 0 ? '0.5' : '1';
        prev.style.cursor = currentIndex === 0 ? 'not-allowed' : 'pointer';
      }
      if (next) {
        next.style.opacity = currentIndex === slides.length - 1 ? '0.5' : '1';
        next.style.cursor = currentIndex === slides.length - 1 ? 'not-allowed' : 'pointer';
      }
    }
    
    function goToSlide(index) {
      if (index < 0) index = 0;
      if (index >= slides.length) index = slides.length - 1;
      currentIndex = index;
      updateSlider();
    }
    
    function nextSlide() {
      if (currentIndex < slides.length - 1) {
        currentIndex++;
        updateSlider();
      }
    }
    
    function prevSlide() {
      if (currentIndex > 0) {
        currentIndex--;
        updateSlider();
      }
    }
    
    if (prev) prev.addEventListener('click', prevSlide);
    if (next) next.addEventListener('click', nextSlide);
    
    // Initialize
    updateSlider();
  });
});
</script>


{% schema %}
{
  "name": "Lookbook",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "section heading",
      "default": "Lookbook"
    }
  ],
  "blocks": [
    {
        "type": "item",
        "name":"lbitem",
        "settings": [
            {
                "type": "image_picker",
                "id":"lbbanner",
                "label":"lbbanner"
            },
            {
                "type":"text",
                "id":"lbbanner_heading",
                "label":"LB Banner Heading"
            },
            {
                "type":"url",
                "id":"lbbuttonlink",
                "label":"LB Button link"
            },
            {
                "type":"text",
                "id":"lbbutton",
                "label":"LB Button"
            },
            {
                "type": "product",
                "id": "product_1",
                "label": "Product 1"
            },
            {
                "type": "product",
                "id": "product_2",
                "label": "Product 2"
            },
            {
                "type": "product",
                "id": "product_3",
                "label": "Product 3"
            },
            {
                "type": "product",
                "id": "product_4",
                "label": "Product 4"
            }
        ]
    }
  ],
  "presets": [
    {
      "name": "Lookbook"
    }
  ]
}


{% endschema %}